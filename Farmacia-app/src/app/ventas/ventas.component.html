<div class="container mt-4">
  <div class="card">
    <div class="card-header">
      <h4>Registrar Venta</h4>
    </div>
    <div class="card-body">
      <form [formGroup]="ventaForm" (ngSubmit)="onSubmit()">
        <div class="mb-3">
          <label class="form-label">Cliente</label>
          <input type="text" formControlName="cliente" class="form-control" [readOnly]="true">
        </div>

        <h5>Detalles de la Venta</h5>
        <div formArrayName="detalles">
          <div *ngFor="let detalle of detalles.controls; let i=index" [formGroupName]="i" class="row align-items-center mb-2">
            <div class="col-md-6">
              <select formControlName="idproducto" class="form-select">
                <option value="">Seleccione un producto</option>
                <option *ngFor="let producto of productos" [value]="producto.id_producto">
                  {{ producto.nom_producto }}
                </option>
              </select>
            </div>
            <div class="col-md-2">
              <input type="number" formControlName="cantidad" class="form-control" placeholder="Cantidad">
            </div>
            <div class="col-md-2">
              <input type="number" formControlName="precio" class="form-control" placeholder="Precio">
            </div>
            <div class="col-md-2">
              <button type="button" class="btn btn-danger" (click)="removeDetalle(i)">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </div>
        </div>

        <button type="button" class="btn btn-info mt-2" (click)="addDetalle()">
          <i class="fas fa-plus"></i> Agregar Producto
        </button>

        <hr>

        <div class="d-flex justify-content-end align-items-center">
          <h4 class="me-4">Total: {{ totalVenta | currency:'S/.' }}</h4>
          <button type="submit" class="btn btn-success me-2" [disabled]="ventaForm.invalid || !cliente">
            <i class="fas fa-save"></i> Registrar Venta
          </button>
          <button type="button" class="btn btn-secondary" (click)="imprimirBoleta()">
            <i class="fas fa-print"></i> Imprimir Boleta
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
